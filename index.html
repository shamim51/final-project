<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Amar Dhaka</title>

    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.3/dist/leaflet.css"
    integrity="sha256-kLaT2GOSpHechhsozzB+flnD+zUyjE2LlfWPgU04xyI="
    crossorigin=""/>

        <!-- Make sure you put this AFTER Leaflet's CSS -->
    <script src="https://unpkg.com/leaflet@1.9.3/dist/leaflet.js"
    integrity="sha256-WBkoXOwTeyKclOHuWtc+i2uENFpDZ9YPdf5Hf+D7ewM="
    crossorigin=""></script>

    <style>
        #map { height: 560px; }
    </style>

</head>
<body>
    <div id="map"></div>

</body>
<script>
    var map = L.map('map').setView([23.7946708, 90.2683664], 13);
    L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png',
    {maxZoom: 19, attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'}).addTo(map);

    navigator.geolocation.watchPosition(success, error);

    let marker, circle;

    function success(pos){
        const lat = pos.coords.latitude;
        console.log(lat);
        
        const lng = pos.coords.longitude;
        console.log(lng);
        const accuracy = pos.coords.accuracy;

        if(marker){
            map.removeLayer(marker);
            map.removeLayer(circle);
        }
        marker = L.marker([lat, lng]).addTo(map);
        circle = L.circle([lat, lng], {radius : accuracy});

        map.fitBounds(circle.getBounds())
    }

    function error(err){
        if(err.code === 1){
            alert("please allow location access");
        }
        else{
            alert("can't get final location");
        }


    }

    var greenIcon = L.icon({
    iconUrl: 'leaf-green.png',
    shadowUrl: 'leaf-shadow.png',

    iconSize:     [38, 95], // size of the icon
    shadowSize:   [50, 64], // size of the shadow
    iconAnchor:   [22, 94], // point of the icon which will correspond to marker's location
    shadowAnchor: [4, 62],  // the same for the shadow
    popupAnchor:  [-3, -76] // point from which the popup should open relative to the iconAnchor
    });

    L.marker([23.79, 90.26], {icon: greenIcon}).addTo(map);
    
    var geojesonF = {
        "type": "FeatureCollection",
        "features": [
            {
            "type": "Feature",
            "properties": {},
            "geometry": {
                "coordinates": [
                [
                    [
                    90.50493724329635,
                    23.855078720476982
                    ],
                    [
                    90.50493724329635,
                    23.846232731426653
                    ],
                    [
                    90.51490451900145,
                    23.846232731426653
                    ],
                    [
                    90.51490451900145,
                    23.855078720476982
                    ],
                    [
                    90.50493724329635,
                    23.855078720476982
                    ]
                ]
                ],
                "type": "Polygon"
            }
            }
        ]
    }
    var geojsonFeature = {
    "type": "FeatureCollection",
    "features": [
        {
        "type": "Feature",
        "properties": {},
        "geometry": {
            "coordinates": [
            [
            [
              90.38397008768368,
              23.874082554430345
            ],
            [
              90.3840317610127,
              23.869331075213097
            ],
            [
              90.39097001040591,
              23.86948617086071
            ],
            [
              90.39080040875558,
              23.87419534711853
            ],
            [
              90.38397008768368,
              23.874082554430345
            ]
            ]
            ],
            "type": "Polygon"
        }
        }
    ]
    }
    L.geoJSON(geojsonFeature).addTo(map);
    L.geoJSON(geojesonF).addTo(map);
</script>

</html>