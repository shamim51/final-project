<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Amar Dhaka</title>

    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.3/dist/leaflet.css"
    integrity="sha256-kLaT2GOSpHechhsozzB+flnD+zUyjE2LlfWPgU04xyI="
    crossorigin=""/>

        <!-- Make sure you put this AFTER Leaflet's CSS -->
    <script src="https://unpkg.com/leaflet@1.9.3/dist/leaflet.js"
    integrity="sha256-WBkoXOwTeyKclOHuWtc+i2uENFpDZ9YPdf5Hf+D7ewM="
    crossorigin=""></script>

    <style>
        #map { height: 900px; }
    </style>
    <link rel="stylesheet" href="Theme_dark.css">

    <script src="area/statesUs.js"></script>
    <script src="area/dhanMondi.js"></script>
    <script src="area/kalabagan.js"></script>
    <script src="area/purbachal.js"></script>
    <script src="area/uttaraSector3.js"></script>
    <script src="area/bashundhara.js"></script>
    <script src="area/lalmatia.js"></script>
    <script src="area/shyamoli.js"></script>
    <script src="area/jigatola.js"></script>
    <script src="area/sherEbanglaNagar.js"></script>
    <script src="area/monipuripara.js"></script>
    <script src="area/tejgaon.js"></script>
    <script src="area/motijheel.js"></script>
    <script src="area/dhakaCityCorporation.js"></script>
    
</head>
<body>
    <div id="map"></div>

</body>
<script>
    var map = L.map('map').setView([23.788212, 90.399971], 11);

    /*L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
    maxZoom: 19,
    attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'}).addTo(map);
    */

    var osm = L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {maxZoom: 19}).addTo(map);


    navigator.geolocation.watchPosition(success, error);

    let marker, circle;
    let lat, lng;

    function success(pos){
        lat = pos.coords.latitude;
        console.log(lat);
        
        lng = pos.coords.longitude;
        console.log(lng);
        const accuracy = pos.coords.accuracy;

        if(marker){
            map.removeLayer(marker);
            map.removeLayer(circle);
        }
        marker = L.marker([lat, lng]).addTo(map);
        circle = L.circle([lat, lng], {radius : accuracy});

        map.fitBounds(circle.getBounds())
    }

    function error(err){
        if(err.code === 1){
            alert("please allow location access");
        }
        else{
            alert("can't get final location");
        }


    }

    var greenIcon = L.icon({
    iconUrl: 'images/leaf-green.png',
    shadowUrl: 'images/leaf-shadow.png',

    iconSize:     [38, 95], // size of the icon
    shadowSize:   [50, 64], // size of the shadow
    iconAnchor:   [22, 94], // point of the icon which will correspond to marker's location
    shadowAnchor: [4, 62],  // the same for the shadow
    popupAnchor:  [-3, -76] // point from which the popup should open relative to the iconAnchor
    });

    marker = L.marker([23.815201, 90.425581], {icon: greenIcon}).addTo(map);

    function style(feature) {
        return {
            fillColor: '#e34a33',
            weight: 2,
            opacity: 1,
            color: 'white',
            dashArray: '3',
            fillOpacity: 0.6
        };
    }
    
    L.geoJSON(statesData, {style:style}).addTo(map);
    L.geoJSON(uttaraSector3, {style:style}).addTo(map);
    L.geoJSON(dhanmondi,{style:style}).addTo(map);
    L.geoJSON(bashundhara, {style:style}).addTo(map);
    L.geoJSON(kalabagan, {style:style}).addTo(map);
    //L.geoJSON(purbachal, {style:style}).addTo(map);
    L.geoJSON(lalmatia, {style:style}).addTo(map);
    L.geoJSON(shyamoli, {style:style}).addTo(map);
    L.geoJSON(jigatola, {style:style}).addTo(map);
    L.geoJSON(sherEbanglaNagar, {style:style}).addTo(map);
    L.geoJSON(monipuripara, {style:style}).addTo(map);
    L.geoJSON(motijheel, {style:style}).addTo(map);
    //L.geoJSON(tejgaon).addTo(map);
    L.geoJSON(dhakaCityCorporation).addTo(map);





    var CyclOSM = L.tileLayer('https://{s}.tile-cyclosm.openstreetmap.fr/cyclosm/{z}/{x}/{y}.png', {
	maxZoom: 20,
	attribution: '<a href="https://github.com/cyclosm/cyclosm-cartocss-style/releases" title="CyclOSM - Open Bicycle render">CyclOSM</a> | Map data: &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
    });

    var OpenStreetMap_France = L.tileLayer('https://{s}.tile.openstreetmap.fr/osmfr/{z}/{x}/{y}.png', {
	maxZoom: 20,
	attribution: '&copy; OpenStreetMap France | &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
    });

    var Esri_WorldImagery = L.tileLayer('https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}', {
	attribution: 'Tiles &copy; Esri &mdash; Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community'
    });
        

    /*var map = L.map('map', {
        center: [39.73, -104.99],
        zoom: 10,
        layers: [osm, cities]
    });*/

    var baseMaps = {
    "OpenStreetMap": osm,
    "CycleOsm":CyclOSM,
    "France_style":OpenStreetMap_France,
    "satelite": Esri_WorldImagery
    
    };

    // var overlayMaps = {
    //     "Cities": marker
    // };

    var layerControl = L.control.layers(baseMaps).addTo(map);


    let arr = [
                [
                    37.799289,
                    -122.266433
                ],
                [
                -74.828057,45.018503
                ],
                [
                    90.43089103637612,
                    23.809003979270642
                ],
                [
                    90.43206280959629,
                    23.809003979270642
                ],
                [
                    90.43277297518347,
                    23.809003979270642
                ]
            ]; 
            
            console.log(arr[1]);

            lat = arr[1][0];
            lng = arr[1][1];

            console.log("lat = "+lat);
            console.log("lng = "+lng);

            if(marker){
                //map.removeLayer(marker);
                //L.marker([23.8152, 90.425581], {icon: greenIcon}).addTo(map);
            }

            //marker = L.marker([lat,lng]).addTo(map);
            //L.marker([lat, lng]).addTo(map);
            //L.marker([lat, lng], {icon: greenIcon}).addTo(map);
            //marker.setLatLng([90.33582398744619, 23.78423442270808]).update(); 
            
            /*for (var i = 0; i < 4; i++) {
                // if(marker){
                //     map.removeLayer(marker);
                // }
                L.marker([23.815201, 90.425581], {icon: greenIcon}).addTo(map);
                //L.marker([23.815201, 90.425581]).addTo(map);
        
                //map.fitBounds(circle.getBounds())
                //L.marker(arr[i]).addTo(map);
            }*/
            
            
            //L.marker(arr(0)).addTo(map);

</script>

</html>