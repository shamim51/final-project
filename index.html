<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Amar Dhaka</title>

    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.3/dist/leaflet.css"
    integrity="sha256-kLaT2GOSpHechhsozzB+flnD+zUyjE2LlfWPgU04xyI="
    crossorigin=""/>

        <!-- Make sure you put this AFTER Leaflet's CSS -->
    <script src="https://unpkg.com/leaflet@1.9.3/dist/leaflet.js"
    integrity="sha256-WBkoXOwTeyKclOHuWtc+i2uENFpDZ9YPdf5Hf+D7ewM="
    crossorigin=""></script>

    <style>
        #map { height: 900px; }
    </style>
    <link rel="stylesheet" href="darkTheme.css">

    <script src="area/statesUs.js"></script>
    <script src="area/dhanMondi.js"></script>
    <script src="area/kalabagan.js"></script>
    <script src="area/purbachal.js"></script>
    <script src="area/uttaraSector3.js"></script>
    <script src="area/bashundhara.js"></script>
    
</head>
<body>
    <div id="map"></div>

</body>
<script>
    var map = L.map('map').setView([23.762055, 90.393019], 13);

    L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png',
    {maxZoom: 24, attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>', className: 'map-tiles'}).addTo(map);

    navigator.geolocation.watchPosition(success, error);

    let marker, circle;

    function success(pos){
        const lat = pos.coords.latitude;
        console.log(lat);
        
        const lng = pos.coords.longitude;
        console.log(lng);
        const accuracy = pos.coords.accuracy;

        if(marker){
            map.removeLayer(marker);
            map.removeLayer(circle);
        }
        marker = L.marker([lat, lng]).addTo(map);
        circle = L.circle([lat, lng], {radius : accuracy});

        map.fitBounds(circle.getBounds())
    }

    function error(err){
        if(err.code === 1){
            alert("please allow location access");
        }
        else{
            alert("can't get final location");
        }


    }

    var greenIcon = L.icon({
    iconUrl: 'car.png',
    shadowUrl: 'leaf-shadow.png',

    iconSize:     [38, 95], // size of the icon
    shadowSize:   [50, 64], // size of the shadow
    iconAnchor:   [22, 94], // point of the icon which will correspond to marker's location
    shadowAnchor: [4, 62],  // the same for the shadow
    popupAnchor:  [-3, -76] // point from which the popup should open relative to the iconAnchor
    });

    L.marker([23.829104179, 90.36438379], {icon: greenIcon}).addTo(map);

    function style(feature) {
        return {
            fillColor: '#FD8D3C',
            weight: 2,
            opacity: 1,
            color: 'white',
            dashArray: '3',
            fillOpacity: 0.7
        };
    }
    
    L.geoJSON(statesData, {style:style}).addTo(map);
    L.geoJSON(uttaraSector3).addTo(map);
    L.geoJSON(dhanmondi, {style:style}).addTo(map);
    L.geoJSON(bashundhara, {style:style}).addTo(map);
    L.geoJSON(kalabagan, {style:style}).addTo(map);
    L.geoJSON(purbachal, {style:style}).addTo(map);
</script>

</html>